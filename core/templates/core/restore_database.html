<!-- core/templates/core/restore_database.html -->
{% extends 'core/base.html' %}

{% block content %}
<a href="{% url 'home' %}" class="back-button">‚Üê –ù–∞–∑–∞–¥</a>

<div class="menu-container">
    <h1 class="menu-title">üì• –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –ë–ê–ó–´ –î–ê–ù–ù–´–• üì•</h1>

    <div class="restore-options">
        <div class="restore-option">
            <h2>üìä –ò–∑ Excel —Ñ–∞–π–ª–∞</h2>
            <p class="option-description">
                ‚Ä¢ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ .xlsx —Ñ–∞–π–ª–∞<br>
                ‚Ä¢ –°–æ–∑–¥–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã<br>
                ‚Ä¢ –£–º–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
            </p>
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="hidden" name="restore_type" value="excel">

                <div class="form-group">
                    <label for="excel_file">–í—ã–±–µ—Ä–∏—Ç–µ Excel —Ñ–∞–π–ª:</label>
                    <input type="file" name="excel_file" accept=".xlsx" required>
                </div>

                <div class="form-group">
                    <label for="restore_mode">–†–µ–∂–∏–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:</label>
                    <select name="restore_mode" id="restore_mode_excel">
                        <option value="smart">üß† –£–º–Ω—ã–π (–ø—Ä–æ–ø—É—Å–∫–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏)</option>
                        <option value="append">‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ (–º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã)</option>
                        <option value="replace">üîÑ –ó–∞–º–µ–Ω–∞ (–æ—á–∏—Å—Ç–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º)</option>
                    </select>
                </div>

                <div class="mode-description" id="mode_desc_excel">
                    <p><strong>–£–º–Ω—ã–π —Ä–µ–∂–∏–º:</strong> –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏, —Å–æ–∑–¥–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã</p>
                </div>

                <button type="submit" class="btn-submit">
                    üìä –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ Excel
                </button>
            </form>
        </div>

        <div class="restore-option">
            <h2>üóÑÔ∏è –ò–∑ SQL –¥–∞–º–ø–∞</h2>
            <p class="option-description">
                ‚Ä¢ –ü–æ–ª–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ .sql —Ñ–∞–π–ª–∞<br>
                ‚Ä¢ –°–æ–∑–¥–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü<br>
                ‚Ä¢ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ —Å–≤—è–∑–∏
            </p>
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="hidden" name="restore_type" value="sql">

                <div class="form-group">
                    <label for="sql_file">–í—ã–±–µ—Ä–∏—Ç–µ SQL —Ñ–∞–π–ª:</label>
                    <input type="file" name="sql_file" accept=".sql" required>
                </div>

                <div class="form-group">
                    <label for="restore_mode">–†–µ–∂–∏–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:</label>
                    <select name="restore_mode" id="restore_mode_sql">
                        <option value="smart">üß† –£–º–Ω—ã–π (–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã)</option>
                        <option value="append">‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ (—Å—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º)</option>
                        <option value="replace">üîÑ –ó–∞–º–µ–Ω–∞ (—É–¥–∞–ª–∏—Ç—å –≤—Å–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å)</option>
                    </select>
                </div>

                <div class="mode-description" id="mode_desc_sql">
                    <p><strong>–£–º–Ω—ã–π —Ä–µ–∂–∏–º:</strong> –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏, —Å–æ–∑–¥–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã</p>
                </div>

                <button type="submit" class="btn-submit">
                    üóÑÔ∏è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ SQL
                </button>
            </form>
        </div>
    </div>

    <div class="info-panel">
        <h3>üìå –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</h3>
        <ul>
            <li><strong>–£–º–Ω—ã–π —Ä–µ–∂–∏–º</strong> - –ª—É—á—à–∏–π –≤—ã–±–æ—Ä –¥–ª—è —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è</li>
            <li><strong>–†–µ–∂–∏–º –∑–∞–º–µ–Ω—ã</strong> - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ë–î</li>
            <li><strong>–†–µ–∂–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è</strong> - —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É–≤–µ—Ä–µ–Ω—ã –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤</li>
            <li>Excel —Ñ–æ—Ä–º–∞—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö</li>
            <li>SQL —Ñ–æ—Ä–º–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü</li>
        </ul>
    </div>
</div>

{% if messages %}
    <div class="messages-container">
        {% for message in messages %}
            <div class="message-box {{ message.tags }}">
                {{ message }}
            </div>
        {% endfor %}
    </div>
{% endif %}

<style>
    .restore-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 30px;
        margin: 40px auto;
        max-width: 1000px;
    }

    .restore-option {
        background-color: #001100;
        border: 2px solid #00ff00;
        border-radius: 10px;
        padding: 25px;
    }

    .restore-option:hover {
        background-color: #002200;
        box-shadow: 0 0 20px rgba(0, 255, 0, 0.4);
    }

    .restore-option h2 {
        color: #00ff00;
        margin-bottom: 15px;
        text-align: center;
    }

    select {
        width: 100%;
        padding: 10px;
        background-color: #000000;
        border: 1px solid #00ff00;
        color: #00ff00;
        font-family: 'Courier New', monospace;
    }

    .mode-description {
        background-color: #000000;
        border: 1px solid #00ff00;
        border-radius: 5px;
        padding: 10px;
        margin-top: 10px;
        font-size: 12px;
    }

    .mode-description p {
        color: #00ffff;
        margin: 0;
    }

    input[type="file"] {
        width: 100%;
        padding: 10px;
        background-color: #000000;
        border: 1px solid #00ff00;
        color: #00ff00;
        font-family: 'Courier New', monospace;
    }

    .info-panel {
        background-color: #001100;
        border: 1px solid #00ff00;
        border-radius: 8px;
        padding: 20px;
        margin: 40px auto;
        max-width: 800px;
    }

    .info-panel h3 {
        color: #00ff00;
        margin-bottom: 15px;
    }

    .info-panel ul {
        list-style: none;
        padding-left: 20px;
        color: #00ff00;
    }

    .info-panel li:before {
        content: "‚Ä¢ ";
        color: #00ff00;
    }

    .info-panel strong {
        color: #00ffff;
    }

    .messages-container {
        max-width: 800px;
        margin: 20px auto;
    }

    .message-box {
        margin: 10px 0;
        padding: 15px;
        border: 2px solid #00ff00;
        border-radius: 5px;
        background-color: #001100;
    }

    .message-box.error {
        border-color: #ff0000;
        color: #ff0000;
        background-color: #110000;
    }

    .message-box.warning {
        border-color: #ffff00;
        color: #ffff00;
        background-color: #111100;
    }

    .message-box.success {
        color: #00ff00;
    }

    .message-box.info {
        border-color: #00ffff;
        color: #00ffff;
    }
</style>

<script>
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è —Ä–µ–∂–∏–º–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
    document.getElementById('restore_mode_excel').addEventListener('change', function() {
        const desc = document.getElementById('mode_desc_excel');
        switch(this.value) {
            case 'smart':
                desc.innerHTML = '<p><strong>–£–º–Ω—ã–π —Ä–µ–∂–∏–º:</strong> –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏, —Å–æ–∑–¥–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã</p>';
                break;
            case 'append':
                desc.innerHTML = '<p><strong>–†–µ–∂–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:</strong> –î–æ–±–∞–≤–ª—è–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ (–º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –ø—Ä–∏ –¥—É–±–ª–∏–∫–∞—Ç–∞—Ö)</p>';
                break;
            case 'replace':
                desc.innerHTML = '<p><strong>–†–µ–∂–∏–º –∑–∞–º–µ–Ω—ã:</strong> –£–¥–∞–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º</p>';
                break;
        }
    });

    document.getElementById('restore_mode_sql').addEventListener('change', function() {
        const desc = document.getElementById('mode_desc_sql');
        switch(this.value) {
            case 'smart':
                desc.innerHTML = '<p><strong>–£–º–Ω—ã–π —Ä–µ–∂–∏–º:</strong> –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏, —Å–æ–∑–¥–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã</p>';
                break;
            case 'append':
                desc.innerHTML = '<p><strong>–°—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º:</strong> –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ</p>';
                break;
            case 'replace':
                desc.innerHTML = '<p><strong>–†–µ–∂–∏–º –∑–∞–º–µ–Ω—ã:</strong> –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö</p>';
                break;
        }
    });
</script>
{% endblock %}