<!-- core/templates/core/entity_list.html -->
{% extends 'core/base.html' %}
{% load custom_filters %}

{% block content %}
<a href="{% url 'entities_menu' %}" class="back-button">‚Üê –ù–∞–∑–∞–¥</a>

<h1 class="menu-title">{{ entity_name }}</h1>

<!-- –§–æ—Ä–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å—Ç–∏–ª—å –∫–Ω–æ–ø–æ–∫) -->
<div style="margin-bottom: 20px;">
    <form method="get" style="display: flex; gap: 10px; align-items: stretch;">
        <div class="form-group" style="margin: 0;">
            <label>–§–∏–ª—å—Ç—Ä –ø–æ –∫–æ–ª–æ–Ω–∫–µ:</label>
            <select name="filter_column">
                <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ --</option>
                {% for col in columns %}
                <option value="{{ col }}" {% if col == filter_column %}selected{% endif %}>{{ col }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group" style="margin: 0;">
            <label>–ó–Ω–∞—á–µ–Ω–∏–µ:</label>
            <input type="text" name="filter_value" value="{{ filter_value }}" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ">
        </div>

        <button type="submit" class="btn-submit" style="height: 42px; align-self: end;">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä</button>

        {% if items %}
            <a href="?save_result=true{% if filter_column %}&filter_column={{ filter_column }}{% endif %}{% if filter_value %}&filter_value={{ filter_value }}{% endif %}"
               class="btn-submit"
               style="text-decoration: none; height: 42px; align-self: end; display: flex; align-items: center;">
               üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            </a>
        {% endif %}

        {% if filter_column and filter_value %}
            <a href="{% url entity_type|add:'_list' %}" class="btn-submit" style="text-decoration: none; height: 42px; align-self: end; display: flex; align-items: center;">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä</a>
        {% endif %}
    </form>
</div>

<!-- –¢–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ (–ª–æ–≥–∏–∫–∞ –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞) -->
<div style="overflow-x: auto;">
    <table>
        <thead>
            <tr>
                {% for col in columns %}
                    <th>
                        {% if col == 'exhibit_id' %}ID
                        {% elif col == 'title' %}–ù–∞–∑–≤–∞–Ω–∏–µ
                        {% elif col == 'description' %}–û–ø–∏—Å–∞–Ω–∏–µ
                        {% elif col == 'creation_date' %}–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
                        {% elif col == 'country' %}–°—Ç—Ä–∞–Ω–∞
                        {% elif col == 'state' %}–°–æ—Å—Ç–æ—è–Ω–∏–µ
                        {% elif col == 'type' %}–¢–∏–ø
                        {% elif col == 'mission_id' %}–ú–∏—Å—Å–∏—è
                        {% elif col == 'employee_id' %}–°–æ—Ç—Ä—É–¥–Ω–∏–∫
                        {% elif col == 'visitor_id' %}ID
                        {% elif col == 'full_name' %}–§–ò–û
                        {% elif col == 'birth_date' %}–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
                        {% elif col == 'citizenship' %}–ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ
                        {% elif col == 'ticket_type' %}–¢–∏–ø –±–∏–ª–µ—Ç–∞
                        {% elif col == 'visit_date' %}–î–∞—Ç–∞ –ø–æ—Å–µ—â–µ–Ω–∏—è
                        {% elif col == 'review' %}–û—Ç–∑—ã–≤
                        {% elif col == 'employee_id' %}ID
                        {% elif col == 'position' %}–î–æ–ª–∂–Ω–æ—Å—Ç—å
                        {% elif col == 'hire_date' %}–î–∞—Ç–∞ –Ω–∞–π–º–∞
                        {% elif col == 'department' %}–û—Ç–¥–µ–ª
                        {% elif col == 'phone' %}–¢–µ–ª–µ—Ñ–æ–Ω
                        {% elif col == 'qualification' %}–ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è
                        {% elif col == 'excursion_id' %}ID
                        {% elif col == 'date' %}–î–∞—Ç–∞
                        {% elif col == 'language' %}–Ø–∑—ã–∫
                        {% elif col == 'ticket_num' %}–ö–æ–ª-–≤–æ –±–∏–ª–µ—Ç–æ–≤
                        {% elif col == 'price' %}–¶–µ–Ω–∞
                        {% elif col == 'duration' %}–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
                        {% elif col == 'exhibition_id' %}ID
                        {% elif col == 'theme' %}–¢–µ–º–∞
                        {% elif col == 'start_date' %}–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞
                        {% elif col == 'end_date' %}–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è
                        {% elif col == 'location' %}–ú–µ—Å—Ç–æ
                        {% elif col == 'mission_id' %}ID
                        {% elif col == 'crew' %}–≠–∫–∏–ø–∞–∂
                        {% elif col == 'goal' %}–¶–µ–ª—å
                        {% else %}{{ col }}
                        {% endif %}
                    </th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr>
                {% for col in columns %}
                <td>
                    {% if entity_type == 'exhibit' %}
                        {% if col == 'exhibit_id' %}{{ item.exhibit_id }}
                        {% elif col == 'title' %}{{ item.title }}
                        {% elif col == 'description' %}{{ item.description|truncatechars:100 }}
                        {% elif col == 'creation_date' %}{{ item.creation_date }}
                        {% elif col == 'country' %}{{ item.country }}
                        {% elif col == 'state' %}{{ item.state }}
                        {% elif col == 'type' %}{{ item.type }}
                        {% elif col == 'mission_id' %}{{ item.mission_title|default:"‚Äî" }}
                        {% else %}{{ item|get_item:col|default:"‚Äî" }}
                        {% endif %}
                    {% elif entity_type == 'excursion' %}
                        {% if col == 'excursion_id' %}{{ item.excursion_id }}
                        {% elif col == 'title' %}{{ item.title }}
                        {% elif col == 'date' %}{{ item.date }}
                        {% elif col == 'language' %}{{ item.language }}
                        {% elif col == 'ticket_num' %}{{ item.ticket_num }}
                        {% elif col == 'price' %}{{ item.price }}
                        {% elif col == 'duration' %}{{ item.duration }}
                        {% elif col == 'employee_id' %}{{ item.employee_name|default:"‚Äî" }}
                        {% else %}{{ item|get_item:col|default:"‚Äî" }}
                        {% endif %}
                    {% elif entity_type == 'mission' %}
                        {% if col == 'mission_id' %}{{ item.mission_id }}
                        {% elif col == 'title' %}{{ item.title }}
                        {% elif col == 'country' %}{{ item.country }}
                        {% elif col == 'start_date' %}{{ item.start_date }}
                        {% elif col == 'end_date' %}{{ item.end_date }}
                        {% elif col == 'crew' %}{{ item.crew|truncatechars:50 }}
                        {% elif col == 'goal' %}{{ item.goal }}
                        {% else %}{{ item|get_item:col|default:"‚Äî" }}
                        {% endif %}
                    {% else %}
                        {{ item|get_item:col|default:"‚Äî" }}
                    {% endif %}
                </td>
                {% endfor %}
            </tr>
            {% empty %}
            <tr>
                <td colspan="{{ columns|length }}" style="text-align: center;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- –ë–ª–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π (–ª–æ–≥–∏–∫–∞ –æ—Ç –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞) -->
{% if messages %}
    {% for message in messages %}
        <div style="margin-top: 20px; padding: 10px; border: 1px solid {% if message.tags == 'error' %}#ff0000{% else %}#00ff00{% endif %}; color: {% if message.tags == 'error' %}#ff0000{% else %}#00ff00{% endif %};">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}
{% endblock %}