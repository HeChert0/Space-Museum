<!-- core/templates/core/save_database.html -->
{% extends 'core/base.html' %}

{% block content %}
<a href="{% url 'home' %}" class="back-button">‚Üê –ù–∞–∑–∞–¥</a>

<div class="menu-container">
    <h1 class="menu-title">üíæ –°–û–•–†–ê–ù–ï–ù–ò–ï –°–û–°–¢–û–Ø–ù–ò–Ø –ë–î üíæ</h1>

    <div class="format-description">
        <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:</p>
    </div>

    <div class="save-options">
        <div class="save-option">
            <h2>üìä Excel —Ñ–æ—Ä–º–∞—Ç</h2>
            <p class="option-description">
                ‚Ä¢ –£–¥–æ–±–µ–Ω –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö<br>
                ‚Ä¢ –ö–∞–∂–¥–∞—è —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ª–∏—Å—Ç–µ<br>
                ‚Ä¢ –ú–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –≤ Excel, LibreOffice<br>
                ‚Ä¢ –¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç–∞–±–ª–∏—Ü—ã
            </p>
            <form method="post" action="{% url 'save_database_excel' %}">
                {% csrf_token %}
                <button type="submit" class="menu-button">
                    üìä –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ Excel (.xlsx)
                </button>
            </form>
        </div>

        <div class="save-option">
            <h2>üóÑÔ∏è SQL Dump</h2>
            <p class="option-description">
                ‚Ä¢ –ü–æ–ª–Ω—ã–π –±—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö<br>
                ‚Ä¢ –í–∫–ª—é—á–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –¥–∞–Ω–Ω—ã–µ<br>
                ‚Ä¢ –ú–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–µ—Ä–µ–∑ pgAdmin<br>
                ‚Ä¢ –°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ SQL –∫–æ–º–∞–Ω–¥—ã
            </p>
            <form method="post" action="{% url 'save_database_sql' %}">
                {% csrf_token %}
                <button type="submit" class="menu-button">
                    üóÑÔ∏è –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ SQL (.sql)
                </button>
            </form>
        </div>
    </div>

    <div class="info-panel">
        <h3>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:</h3>
        <div class="db-stats">
            <div class="stat-item">
                <span class="stat-label">–í—Å–µ–≥–æ —Ç–∞–±–ª–∏—Ü:</span>
                <span class="stat-value">{{ total_tables }}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü:</span>
                <span class="stat-value">{{ user_tables }}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π:</span>
                <span class="stat-value">{{ total_records }}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">–†–∞–∑–º–µ—Ä –ë–î:</span>
                <span class="stat-value">{{ db_size }}</span>
            </div>
        </div>
    </div>
</div>

{% if messages %}
    {% for message in messages %}
        <div class="message-box {{ message.tags }}">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<style>
    .format-description {
        text-align: center;
        margin: 30px 0;
        color: #00ff00;
        font-size: 18px;
    }

    .save-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 30px;
        margin: 40px auto;
        max-width: 900px;
    }

    .save-option {
        background-color: #001100;
        border: 2px solid #00ff00;
        border-radius: 10px;
        padding: 25px;
        transition: all 0.3s;
    }

    .save-option:hover {
        background-color: #002200;
        box-shadow: 0 0 20px rgba(0, 255, 0, 0.4);
        transform: translateY(-5px);
    }

    .save-option h2 {
        color: #00ff00;
        margin-bottom: 15px;
        text-align: center;
        font-size: 24px;
    }

    .option-description {
        color: #00ff00;
        margin-bottom: 20px;
        line-height: 1.6;
        font-size: 14px;
    }

    .info-panel {
        background-color: #001100;
        border: 1px solid #00ff00;
        border-radius: 8px;
        padding: 20px;
        margin: 40px auto;
        max-width: 600px;
    }

    .info-panel h3 {
        color: #00ff00;
        margin-bottom: 15px;
        text-align: center;
    }

    .db-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
    }

    .stat-item {
        display: flex;
        justify-content: space-between;
        padding: 8px 15px;
        background-color: #000000;
        border: 1px solid #00ff00;
        border-radius: 5px;
    }

    .stat-label {
        color: #00ff00;
        font-weight: bold;
    }

    .stat-value {
        color: #00ffff;
    }

    .message-box {
        margin: 20px auto;
        max-width: 600px;
        padding: 15px;
        border: 2px solid #00ff00;
        border-radius: 5px;
        text-align: center;
    }

    .message-box.error {
        border-color: #ff0000;
        color: #ff0000;
    }
</style>
{% endblock %}